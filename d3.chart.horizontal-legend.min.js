/*! d3.chart.horizontal-legend - v0.1.0
 *  License: MIT Expat
 *  Date: 2013-05-27
 */
(function(){d3.chart("HorizontalLegend",{initialize:function(){function t(){return this.attr("x",function(t){return a.position_scale(t)}).attr("width",a.box_width).style("fill",a.scale)}function e(){var t=a.scale.domain();return this.text(function(e){return 0===t[0]&&1>=t[1]?e>.01||0===e?d3.format("%")(e):d3.format(".1%")(e.toFixed(2)):e})}var a=this;a.base.classed("HorizontalLegend",!0),a.w=a.base.attr("width"),a.h=a.base.attr("height");var i=a.base.append("g").classed("labels",!0).attr("height",a.h).attr("width",a.w),s=a.layer("labels",i,{dataBind:function(t){a.scale=t;var e=t.domain();return this.selectAll("text").data(e)},insert:function(){var t=this.append("text").attr("class","label");return t.attr("transform",function(t,e){return 0===e?"translate(0,0)":"translate("+a.w+",0)"}).attr("text-anchor",function(t,e){return 0===e?"start":"end"}).attr("dy",a.h-3),t}}),h=this.base.append("g").classed("boxes",!0).attr("width",a.base.attr("width")).attr("height",a.base.attr("height")),n=a.layer("boxes",h,{dataBind:function(t){a.scale=t;for(var e=t.domain(),i=[],s=e[0];e[1]>=s;s+=(e[1]-e[0])/a.b)i.push(s);var h=a.layer("labels").selectAll("text")[0],n=h[0].getBBox().width,r=h[1].getBBox().width;return a.box_width=(a.w-r-n-(a.b-1)*a.pad)/a.b,a.position_scale=d3.scale.linear().domain(e).range([n+a.pad,a.w-r-a.box_width-a.pad]),this.selectAll("rect").remove(),this.selectAll("rect").data(i)},insert:function(){return this.append("rect").attr("y",0).attr("height",a.h)}});return s.on("enter",e),s.on("update",e),n.on("enter",t),n.on("update",t),a},padding:function(t){return arguments.length?(this.pad=t,this.box_width=(this.w-(this.b-1)*this.pad)/this.b,this.scale&&this.draw(this.scale),this):this.pad},boxes:function(t){return arguments.length?(this.b=t,this.box_width=(this.w-(this.b-1)*this.pad)/this.b,this.scale&&this.draw(this.scale),this):this.b},width:function(t){return arguments.length?(this.w=t,this.x=d3.scale.linear().range([0,this.w]),this.base.attr("width",this.w),this.scale&&this.draw(this.scale),this):this.w},height:function(t){return arguments.length?(this.h=t,this.base.attr("height",this.h),this.scale&&this.draw(this.scale),this):this.h}})})();